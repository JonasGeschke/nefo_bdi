---
title: "Analyse der NeFo-GEOEssential-Umfrage zur Biodiversitätsdatenintegration"
date: "2018"
header-includes:
   - \usepackage{longtable}
output:
  pdf_document:
    toc: yes
  documentclass: article
  html_document:
    toc: yes
  classoption: a4paper
  graphics: yes
---

# Einleitung
Dieses ist das Skript der Analyse der NeFo-GEOEssential-Umfrage zur Biodiversitätsdatenintegration. Das Skrpit ist verfügbar unter https://github.com/JonasGeschke/nefo_bdi


# Einstellungen

```{r set wd - CHOOSE, eval=FALSE}
# If your working directory is not already specified because you are running this
# script within a project, you will need to use the setwd() function below to set
# the path of your working directory. In order to do this just copy the path
# between the quote signs.
# Please note: The different levels of the path need to be separated by slashes
# ("/"), not by backslashes ("\") which are the windows default.
# 
# setwd("")

setwd("U:/Workshops_orga/Biodiv_Datenintegration/Umfrage/R") # Jonas
```

```{r install packages, eval=FALSE}
# Installing required packages if not installed yet
if("xlsx" %in% rownames(installed.packages())   == FALSE){
  install.packages("xlsx")}
```

```{r set additional functions, eval=FALSE}
'%!in%' <- function(x,y)!('%in%'(x,y))
```


# Analyse

```{r Laden der Rohdaten und Vorbereitung der Daten, eval=FALSE}
## Load raw data
Raw_deutsch <- read.csv2(file = "Daten/umfrage_zur_biodiversitatsdatenintegration_in_deutschland.csv", 
                         header = F, sep = ";", fileEncoding = "UTF8", 
                         na.strings = "", stringsAsFactors = TRUE)
Raw_englisch <- read.csv2(file = "Daten/questionnaire_on_integration_of_biodiversity_data_in_germany.csv", 
                          header = F, sep = ";", fileEncoding = "UTF8", 
                          na.strings = "", stringsAsFactors = TRUE)

gesamt <- rbind(Raw_deutsch[-which(Raw_deutsch$V9 == "nefo"),], Raw_englisch[-c(1:3, which(Raw_englisch$V9 == "nefo")),])
gesamt <- gesamt[-c(1:3),-c(1:9)]


# Qualitative Antworten
Q1_1 <- gesamt[,c(1:5)]
names(Q1_1) <- c("Datenbereitstellung", "Datenaufbereitung", "Datenverschmelzung", "anderes", "Info")
xlsx::write.xlsx(Q1_1, file = "Q1_1.xls")

Q1_3 <- gesamt[,7]
xlsx::write.xlsx(Q1_3, file = "Q1_3.xls")

Q1_4 <- gesamt[,c(8:10)]
names(Q1_4) <- c("a", "b", "c")
xlsx::write.xlsx(Q1_4, file = "Q1_4.xls")

Q1_5 <- gesamt[,c(11:13)]
names(Q1_5) <- c("a", "b", "c")
xlsx::write.xlsx(Q1_5, file = "Q1_5.xls")

Q1_6 <- gesamt[,c(14:16)]
names(Q1_6) <- c("a", "b", "c")
xlsx::write.xlsx(Q1_6, file = "Q1_6.xls")

Q3_2 <- gesamt[,c(29:36)]
names(Q3_2) <- c("LIDAR", "RADAR", "Multi", "Hyper", "Wärme", "Ortho", "andere", "Info")
xlsx::write.xlsx(Q3_2, file = "Q3_2.xls")

Q3_5 <- gesamt[,c(85:98)]
names(Q3_5) <- c("NBS", "EU-BS", "GAP", "Natura", "FFH", "CBD", "IPBES", "CITES", "CMS", "EUROBATS", "Ramsar", "GEO", "andere", "Info")
xlsx::write.xlsx(Q3_5, file = "Q3_5.xls")

Q3_6 <- gesamt[,c(99:101)]
Q3_6[9,1] <- NA
xlsx::write.xlsx(Q3_6, file = "Q3_6.xls")

Q4_4 <- gesamt[,c(111:112)]
names(Q4_4) <- c("Tätigkeit", "Info")
xlsx::write.xlsx(Q4_4, file = "Q4_4.xls")

Feedback <- gesamt[,118]
Feedback[c(22,43)] <- NA
xlsx::write.xlsx(Feedback, file = "Feedback.xls")

# Quantitative Antworten
Q1_1 <- xlsx::read.xlsx(file = "Daten/results.xlsx", sheetIndex = 1, encoding="UTF-8", header = F)

```



---
title: "Analyse der NeFo-GEOEssential-Umfrage zur Biodiversitätsdatenintegration"
date: "2018"
header-includes:
   - \usepackage{longtable}
output:
  pdf_document:
    toc: yes
  documentclass: article
  html_document:
    toc: yes
  classoption: a4paper
  graphics: yes
---

# Einleitung
Dieses ist das Skript der Analyse der NeFo-GEOEssential-Umfrage zur Biodiversitätsdatenintegration. Das Skrpit ist verfügbar unter https://github.com/JonasGeschke/nefo_bdi


# Einstellungen

```{r set wd - CHOOSE, eval=FALSE}
# If your working directory is not already specified because you are running this
# script within a project, you will need to use the setwd() function below to set
# the path of your working directory. In order to do this just copy the path
# between the quote signs.
# Please note: The different levels of the path need to be separated by slashes
# ("/"), not by backslashes ("\") which are the windows default.
# 
# setwd("")

setwd("U:/Workshops_orga/Biodiv_Datenintegration/Umfrage/R") # Jonas
```

```{r install packages, eval=FALSE}
# Installing required packages if not installed yet
if("xlsx" %in% rownames(installed.packages())   == FALSE){
  install.packages("xlsx")}
```

```{r set additional functions, eval=FALSE}
'%!in%' <- function(x,y)!('%in%'(x,y))
```


# Analyse

```{r Laden der Rohdaten und Vorbereitung der Daten, eval=FALSE}
## Load raw data
Raw_deutsch <- read.csv2(file = "Daten/umfrage_zur_biodiversitatsdatenintegration_in_deutschland.csv", 
                         header = F, sep = ";", fileEncoding = "UTF8", 
                         na.strings = "", stringsAsFactors = FALSE)
Raw_englisch <- read.csv2(file = "Daten/questionnaire_on_integration_of_biodiversity_data_in_germany.csv", 
                          header = F, sep = ";", fileEncoding = "UTF8", 
                          na.strings = "", stringsAsFactors = FALSE)

gesamt <- rbind(Raw_deutsch[-which(Raw_deutsch$V9 == "nefo"),], Raw_englisch[-c(1:3, which(Raw_englisch$V9 == "nefo")),])
gesamt <- gesamt[,-c(2:5)]

# Qualitative Antworten
Q1_1 <- gesamt[,c(1:5)]
names(Q1_1) <- c("Datenbereitstellung", "Datenaufbereitung", "Datenverschmelzung", "anderes", "Info")
xlsx::write.xlsx(Q1_1, file = "Q1_1.xls")

Q1_3 <- gesamt[,7]
xlsx::write.xlsx(Q1_3, file = "Q1_3.xls")

Q1_4 <- gesamt[,c(8:10)]
names(Q1_4) <- c("a", "b", "c")
xlsx::write.xlsx(Q1_4, file = "Q1_4.xls")

Q1_5 <- gesamt[,c(11:13)]
names(Q1_5) <- c("a", "b", "c")
xlsx::write.xlsx(Q1_5, file = "Q1_5.xls")

Q1_6 <- gesamt[,c(14:16)]
names(Q1_6) <- c("a", "b", "c")
xlsx::write.xlsx(Q1_6, file = "Q1_6.xls")

Q3_2 <- gesamt[,c(29:36)]
names(Q3_2) <- c("LIDAR", "RADAR", "Multi", "Hyper", "Wärme", "Ortho", "andere", "Info")
xlsx::write.xlsx(Q3_2, file = "Q3_2.xls")

Q3_5 <- gesamt[,c(85:98)]
names(Q3_5) <- c("NBS", "EU-BS", "GAP", "Natura", "FFH", "CBD", "IPBES", "CITES", "CMS", "EUROBATS", "Ramsar", "GEO", "andere", "Info")
xlsx::write.xlsx(Q3_5, file = "Q3_5.xls")

Q3_6 <- gesamt[,c(99:101)]
Q3_6[9,1] <- NA
xlsx::write.xlsx(Q3_6, file = "Q3_6.xls")

Q4_4 <- gesamt[,c(111:112)]
names(Q4_4) <- c("Tätigkeit", "Info")
xlsx::write.xlsx(Q4_4, file = "Q4_4.xls")

Feedback <- gesamt[,118]
Feedback[c(22,43)] <- NA
xlsx::write.xlsx(Feedback, file = "Feedback.xls")

# Quantitative Antworten
results <- xlsx::read.xlsx(file = "Daten/results.xlsx", sheetIndex = 1, encoding="UTF-8")
Q1_1 <- factor(results$Q1_1, levels = c("Datenbereitstellung", 
                                        "Datenaufbereitung",
                                        "Datenverschmelzung",
                                        "Mit keinem 'dieser' Schritte"))
Q1_2 <- factor(results$Q1_2, levels = c("0 bis 25%", 
                                        "26 bis 50%",
                                        "51 bis 75%",
                                        "76 bis 100%"))
Q2_1 <- factor(results$Q2_1, levels = c("Ja", 
                                        "Nein"))
Q2_4 <- factor(results$Q2_4, levels = c("Ja", 
                                        "Nein",
                                        "In Teilen"))
Q3_1 <- factor(results$Q3_1, levels = c("Ja", 
                                        "Nein"))
Q3_2 <- factor(results$Q3_2, levels = c("Light Detection and Ranging (LIDAR)", 
                                        "Radio Detection and Ranging (RADAR)",
                                        "Multispektrale Bilder",
                                        "Hyperspektrale Bilder",
                                        "Wärmebilder",
                                        "Luftbilder/ Orthophotos",
                                        "Andere"))
Q3_3 <- factor(results$Q3_3, levels = c("Biodiversitätsmonitoring", 
                                        "Politische Berichterstattung",
                                        "Forschung",
                                        "Planung",
                                        "Beratung",
                                        "Andere privatwirtschaftliche Zwecke"))
Q3_5 <- factor(results$Q3_5, levels = c("Deutsche Nationale Biodiversitätsstrategie", 
                                        "Europäische Biodiversitätsstrategie",
                                        "Gemeinsame Agrarpolitik der EU (GAP)",
                                        "Natura 2000",
                                        "Fauna-Flora-Habitat-Richtlinie (FFH)",
                                        "Übereinkommen über die biologische Vielfalt (CBD)",
                                        "Intergovernmental science-policy Platform on Biodiversity and Ecosystem Services (IPBES)",
                                        "Washingtoner Artenschutzabkommen (CITES",
                                        "Übereinkommen zur Erhaltung wandernder wild lebender Tierarten (CMS)",
                                        "Abkommen zur Erhaltung der europäischen Fledermauspopulationen (EUROBATS)",
                                        "Übereinkommen über Feuchtgebiete (Ramsar)",
                                        "Group on Earth Observations (GEO)",
                                        "Andere"))
Q4_1 <- factor(results$Q4_1, levels = c("Männlich", 
                                        "Weiblich"))
Q4_2 <- factor(results$Q4_2, levels = c("25-34 Jahre", 
                                        "35-44 Jahre", 
                                        "45-59 Jahre", 
                                        "60-69 Jahre", 
                                        "70 Jahre und älter"))
Q4_3 <- factor(results$Q4_3, levels = c("Sekundarstufe II", 
                                        "Abitur", 
                                        "Master", 
                                        "Diplom", 
                                        "Promotion", 
                                        "Habilitation"))
Q4_4 <- factor(results$Q4_4, levels = c("Professor_in",
                                        "Post-Doc",
                                        "Wissenschaftliche_r Angestellte_r ohne Doktortitel",
                                        "Doktorand_in",
                                        "Technische_r Angestellte_r",
                                        "Angestellte_r in Administration und Management",
                                        "Andere"))
Q4_5 <- factor(results$Q4_5, levels = c("Akademische Tätigkeit: Forschung",
                                        "Akademische Tätigkeit: Forschung und Lehre",
                                        "Regierung oder Behörde",
                                        "Privatwirtschaft",
                                        "Verein oder NGO"))
Q4_6 <- factor(results$Q4_6, levels = c("Lokal/ Regional innerhalb Deutschland",
                                        "National in Gesamt-Deutschland",
                                        "Europa",
                                        "International (über Europa hinaus)"))

Q2_2 <- xlsx::read.xlsx(file = "Daten/results.xlsx", sheetIndex = 2, encoding="UTF-8")
row.names(Q2_2) <- Q2_2[,1]
Q2_2 <- t(Q2_2[,-1])

Q2_3 <- xlsx::read.xlsx(file = "Daten/results.xlsx", sheetIndex = 3, encoding="UTF-8")
row.names(Q2_3) <- Q2_3[,1]
Q2_3 <- t(Q2_3[,-1])

Q3_4 <- xlsx::read.xlsx(file = "Daten/results.xlsx", sheetIndex = 4, encoding="UTF-8")
row.names(Q3_4) <- Q3_4[,1]
Q3_4 <- t(Q3_4[,-1])



```

```{r quantitative Ergebnisse roh, eval=FALSE}
ergebnisse <- read.csv2(file = "Daten/ergebnisse.csv", 
                         header = TRUE, sep = ";", fileEncoding = "UTF8", 
                         na.strings = "", stringsAsFactors = FALSE)
ergebnisse[ergebnisse == "X"] <- 1

Q1_1 <- ergebnisse[,c(2:5)]
Q1_1 <- transform(Q1_1, X1_1_a = as.numeric(X1_1_a), 
                        X1_1_b = as.numeric(X1_1_b), 
                        X1_1_c = as.numeric(X1_1_c), 
                        X1_1_d = as.numeric(X1_1_d))

Q1_2 <- factor(ergebnisse$X1_2, levels = c("1_2_a", "1_2_b", "1_2_c", "1_2_d"))

Q2_1 <- factor(ergebnisse$X2_1, levels = c("2_1_a", "2_1_b"))

Q2_2 <- ergebnisse[,c(19:22)]
Q2_2_table <- data.frame(matrix(NA, ncol = 4, nrow = 4))
names(Q2_2_table) <- c("2_2_a", "2_2_b", "2_2_c", "2_2_d")
Q2_2_table[1,1] <- length(which(Q2_2$X2_2_1 == "2_2_a"))
Q2_2_table[1,2] <- length(which(Q2_2$X2_2_1 == "2_2_b"))
Q2_2_table[1,3] <- length(which(Q2_2$X2_2_1 == "2_2_c"))
Q2_2_table[1,4] <- length(which(Q2_2$X2_2_1 == "2_2_d"))
Q2_2_table[2,1] <- length(which(Q2_2$X2_2_2 == "2_2_a"))
Q2_2_table[2,2] <- length(which(Q2_2$X2_2_2 == "2_2_b"))
Q2_2_table[2,3] <- length(which(Q2_2$X2_2_2 == "2_2_c"))
Q2_2_table[2,4] <- length(which(Q2_2$X2_2_2 == "2_2_d"))
Q2_2_table[3,1] <- length(which(Q2_2$X2_2_3 == "2_2_a"))
Q2_2_table[3,2] <- length(which(Q2_2$X2_2_3 == "2_2_b"))
Q2_2_table[3,3] <- length(which(Q2_2$X2_2_3 == "2_2_c"))
Q2_2_table[3,4] <- length(which(Q2_2$X2_2_3 == "2_2_d"))
Q2_2_table[4,1] <- length(which(Q2_2$X2_2_4 == "2_2_a"))
Q2_2_table[4,2] <- length(which(Q2_2$X2_2_4 == "2_2_b"))
Q2_2_table[4,3] <- length(which(Q2_2$X2_2_4 == "2_2_c"))
Q2_2_table[4,4] <- length(which(Q2_2$X2_2_4 == "2_2_d"))
Q2_2 <- t(Q2_2_table)
rm(Q2_2_table)
names(Q2_2) <- c("2_2_1", "2_2_2", "2_2_3", "2_2_4")

Q2_3 <- ergebnisse[,c(23:27)]
Q2_3_table <- data.frame(matrix(NA, ncol = 4, nrow = 5))
names(Q2_3_table) <- c("2_3_a", "2_3_b", "2_3_c", "2_3_d")
Q2_3_table[1,1] <- length(which(Q2_3$X2_3_1 == "2_3_a"))
Q2_3_table[1,2] <- length(which(Q2_3$X2_3_1 == "2_3_b"))
Q2_3_table[1,3] <- length(which(Q2_3$X2_3_1 == "2_3_c"))
Q2_3_table[1,4] <- length(which(Q2_3$X2_3_1 == "2_3_d"))
Q2_3_table[2,1] <- length(which(Q2_3$X2_3_2 == "2_3_a"))
Q2_3_table[2,2] <- length(which(Q2_3$X2_3_2 == "2_3_b"))
Q2_3_table[2,3] <- length(which(Q2_3$X2_3_2 == "2_3_c"))
Q2_3_table[2,4] <- length(which(Q2_3$X2_3_2 == "2_3_d"))
Q2_3_table[3,1] <- length(which(Q2_3$X2_3_3 == "2_3_a"))
Q2_3_table[3,2] <- length(which(Q2_3$X2_3_3 == "2_3_b"))
Q2_3_table[3,3] <- length(which(Q2_3$X2_3_3 == "2_3_c"))
Q2_3_table[3,4] <- length(which(Q2_3$X2_3_3 == "2_3_d"))
Q2_3_table[4,1] <- length(which(Q2_3$X2_3_4 == "2_3_a"))
Q2_3_table[4,2] <- length(which(Q2_3$X2_3_4 == "2_3_b"))
Q2_3_table[4,3] <- length(which(Q2_3$X2_3_4 == "2_3_c"))
Q2_3_table[4,4] <- length(which(Q2_3$X2_3_4 == "2_3_d"))
Q2_3_table[5,1] <- length(which(Q2_3$X2_3_5 == "2_3_a"))
Q2_3_table[5,2] <- length(which(Q2_3$X2_3_5 == "2_3_b"))
Q2_3_table[5,3] <- length(which(Q2_3$X2_3_5 == "2_3_c"))
Q2_3_table[5,4] <- length(which(Q2_3$X2_3_5 == "2_3_d"))
Q2_3 <- t(Q2_3_table)
rm(Q2_3_table)
names(Q2_3) <- c("2_3_1", "2_3_2", "2_3_3", "2_3_4", "2_3_5")

Q2_4 <- factor(ergebnisse$X2_4, levels = c("2_4_a", "2_4_b", "2_4_c"))

Q3_1 <- factor(ergebnisse$X3_1, levels = c("3_1_a", "3_1_b"))

Q3_2 <- ergebnisse[,c(30:36)]
Q3_2 <- transform(Q3_2, X3_2_a = as.numeric(X3_2_a), 
                        X3_2_b = as.numeric(X3_2_b), 
                        X3_2_c = as.numeric(X3_2_c), 
                        X3_2_d = as.numeric(X3_2_d),
                        X3_2_e = as.numeric(X3_2_e),
                        X3_2_f = as.numeric(X3_2_f),
                        X3_2_g = as.numeric(X3_2_g))

Q3_3 <- ergebnisse[,c(38:43)]
Q3_3 <- transform(Q3_3, X3_3_a = as.numeric(X3_3_a), 
                        X3_3_b = as.numeric(X3_3_b), 
                        X3_3_c = as.numeric(X3_3_c), 
                        X3_3_d = as.numeric(X3_3_d),
                        X3_3_e = as.numeric(X3_3_e),
                        X3_3_f = as.numeric(X3_3_f))

Q3_4 <- xlsx::read.xlsx(file = "Daten/results.xlsx", sheetIndex = 4, encoding="UTF-8") ##########################
row.names(Q3_4) <- Q3_4[,1]
Q3_4 <- Q3_4[,-1]
names(Q3_4) <- c("sehr schlecht", "eher schlecht", "eher gut", "sehr gut", "weiß nicht")
str(Q3_4)
Q3_4 <- t(Q3_4)

Q3_5 <- ergebnisse[,c(86:98)]
Q3_5 <- transform(Q3_5, X3_5_a = as.numeric(X3_5_a), 
                        X3_5_b = as.numeric(X3_5_b), 
                        X3_5_c = as.numeric(X3_5_c), 
                        X3_5_d = as.numeric(X3_5_d),
                        X3_5_e = as.numeric(X3_5_e),
                        X3_5_f = as.numeric(X3_5_f),
                        X3_5_g = as.numeric(X3_5_g), 
                        X3_5_h = as.numeric(X3_5_h), 
                        X3_5_i = as.numeric(X3_5_i), 
                        X3_5_j = as.numeric(X3_5_j),
                        X3_5_k = as.numeric(X3_5_k),
                        X3_5_l = as.numeric(X3_5_l),
                        X3_5_m = as.numeric(X3_5_m))

Q3_7 <- factor(ergebnisse$X3_7, levels = c("3_7_a", "3_7_b"))




```


# Visualisierung

```{r Barplots, eval=FALSE}
Q1_1_sum <- colSums(Q1_1, na.rm = TRUE)
Q1_1_rel <- 100/sum(Q1_1_sum)*Q1_1_sum
q1_1 <- barplot(Q1_1_rel,
        main = "Mit welchem dieser Schritte der Biodiversitätsdatenintegration beschäftigen Sie sich?", 
        sub = paste("total n", "=", length(rowSums(Q1_1, na.rm=T)!=0), sep = " "),
        names.arg = c("Datenbereitstellung", "Datenaufbereitung", "Datenverschmelzung", "Mit keinem 'dieser' Schritte"),
        ylim = c(0,max(Q1_1_rel)+5), yaxt='n')
text(x = q1_1, y = Q1_1_rel, label = paste("n = ", Q1_1_sum, " / ", round(Q1_1_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q1_2_sum <- as.numeric(table(Q1_2))
names(Q1_2_sum) <- c("1_2_a", "1_2_b", "1_2_c", "1_2_d")
Q1_2_rel <- 100/sum(Q1_2_sum)*Q1_2_sum
q1_2 <- barplot(Q1_2_rel,
        main = "Wie viel Prozent Ihrer Arbeitszeit beschäftigen Sie sich mit der Biodiversitätsdatenintegration?", 
        sub = paste("total n", "=", length(ergebnisse$X1_2[!is.na(ergebnisse$X1_2) == T]), sep = " "),
        names.arg = c("0 bis 25%", "26 bis 50%", "51 bis 75%", "76 bis 100%"),
        ylim = c(0,max(Q1_2_rel)+5), yaxt='n')
text(x = q1_2, y = Q1_2_rel, label = paste("n = ", Q1_2_sum, " / ", round(Q1_2_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q2_1_sum <- as.numeric(table(Q2_1))
names(Q2_1_sum) <- c("2_1_a", "2_1_b")
Q2_1_rel <- 100/sum(Q2_1_sum)*Q2_1_sum
q2_1 <- barplot(Q2_1_rel,
        main = "Haben Sie bereits von den FAIR-Prinzipien gehört?", 
        sub = paste("total n", "=", length(ergebnisse$X2_1[!is.na(ergebnisse$X2_1) == T]), sep = " "),
        names.arg = c("Ja", "Nein"),
        ylim = c(0,max(Q2_1_rel)+5), yaxt='n')
text(x = q2_1, y = Q2_1_rel, label = paste("n = ", Q2_1_sum, " / ", round(Q2_1_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q2_2_sum <- as.numeric(colSums(Q2_2))
names(Q2_2_sum) <- c("2_2_1", "2_2_2", "2_2_3", "2_2_4")
Q2_2_rel <- 100/Q2_2_sum*Q2_2
row.names(Q2_2_rel) <- c("unwichtig", "eher nicht wichtig", "eher wichtig", "sehr wichtig")
q2_2 <- barplot(Q2_2_rel,
        main = "Als wie wichtig erachten Sie die vier FAIR-Prinzipien für die Integration von Biodiversitätsdaten?", 
        sub = paste("mean n", "=", mean(Q2_2_sum), sep = " "),
        names.arg = c("auffindbar", "zugänglich", "harmonisiert", "nachnutzbar"),
        ylim = c(0,max(Q2_2_rel)+5), yaxt='n',
        beside = TRUE,
        legend.text = TRUE,
        args.legend = list("topright", bty = "n"))
text(x = q2_2, y = Q2_2_rel, label = paste("n = ", Q2_2, " / ", round(Q2_2_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q2_3_sum <- as.numeric(colSums(Q2_3))
names(Q2_3_sum) <- c("2_3_1", "2_3_2", "2_3_3", "2_3_4", "2_3_5")
Q2_3_rel <- 100/Q2_3_sum*Q2_3
row.names(Q2_3_rel) <- c("sehr schlecht", "eher schlecht", "eher gut", "sehr gut")
q2_3 <- barplot(Q2_3_rel,
        main = "Als wie gut finden Sie die vier FAIR-Prinzipen bei Biodiversitätsdaten in Deutschland bereits umgesetzt?", 
        sub = paste("mean n", "=", mean(Q2_3_sum), sep = " "),
        names.arg = c("auffindbar", "zugänglich", "harmonisiert", "nachnutzbar", "insgesamt"),
        ylim = c(0,max(Q2_3_rel)+20), yaxt='n',
        beside = TRUE, 
        legend.text = TRUE,
        args.legend = list("topright", bty = "n"))
text(x = q2_3, y = Q2_3_rel, label = paste("n = ", Q2_3, " / ", round(Q2_3_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q2_4_sum <- as.numeric(table(Q2_4))
names(Q2_4_sum) <- c("2_4_a", "2_4_b", "2_4_c")
Q2_4_rel <- 100/sum(Q2_4_sum)*Q2_4_sum
q2_4 <- barplot(Q2_4_rel,
        main = "Handeln Sie in Ihrer Forschung oder Arbeit bereits nach dem Prinzip des FAIRen Datenmanagements?", 
        sub = paste("total n", "=", length(ergebnisse$X2_4[!is.na(ergebnisse$X2_4) == T]), sep = " "),
        names.arg = c("Ja", "Nein", "In Teilen"),
        ylim = c(0,max(Q2_4_rel)+5), yaxt='n')
text(x = q2_4, y = Q2_4_rel, label = paste("n = ", Q2_4_sum, " / ", round(Q2_4_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q3_1_sum <- as.numeric(table(Q3_1))
names(Q3_1_sum) <- c("3_1_a", "3_1_b")
Q3_1_rel <- 100/sum(Q3_1_sum)*Q3_1_sum
q3_1 <- barplot(Q3_1_rel,
        main = "Nutzen Sie bereits Fernerkundungsdaten in Ihrer Arbeit?", 
        sub = paste("total n", "=", length(ergebnisse$X3_1[!is.na(ergebnisse$X3_1) == T]), sep = " "),
        names.arg = c("Ja", "Nein"),
        ylim = c(0,max(Q3_1_rel)+5), yaxt='n')
text(x = q3_1, y = Q3_1_rel, label = paste("n = ", Q3_1_sum, " / ", round(Q3_1_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q3_2_sum <- colSums(Q3_2, na.rm = TRUE)
Q3_2_rel <- 100/sum(Q3_2_sum)*Q3_2_sum
q3_2 <- barplot(Q3_2_rel,
        main = "Welche Art(en) von Fernerkundungsdaten nutzen Sie?", 
        sub = paste("total n", "=", length(which(rowSums(Q3_2, na.rm=T)!=0)), sep = " "),
        names.arg = c("LIDAR", "RADAR", "multispetral", "hyperspektral", "Wärmebilder", "Orthophotos", "andere"),
        ylim = c(0,max(Q3_2_rel)+5), yaxt='n')
text(x = q3_2, y = Q3_2_rel, label = paste("n = ", Q3_2_sum, " / ", round(Q3_2_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q3_3_sum <- colSums(Q3_3, na.rm = TRUE)
Q3_3_rel <- 100/sum(Q3_3_sum)*Q3_3_sum
q3_3 <- barplot(Q3_3_rel,
        main = "Für welche(n) Zweck(e) nutzen Sie Fernerkundungsdaten?", 
        sub = paste("total n", "=", length(which(rowSums(Q3_3, na.rm=T)!=0)), sep = " "),
        names.arg = c("Biodiversitätsmonitoring", "Pol. Berichterstattung", "Forschung", "Planung", "Beratung", "andere privatwirtschaftl. Zwecke"),
        ylim = c(0,max(Q3_3_rel)+5), yaxt='n')
text(x = q3_3, y = Q3_3_rel, label = paste("n = ", Q3_3_sum, " / ", round(Q3_3_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q3_4_sum <- colSums(t(Q3_4), na.rm = TRUE) ################################
Q3_4_rel <- 100/Q3_4_sum*t(Q3_4)
Q3_4_rel <- t(Q3_4_rel)
Q3_4_rel[,6] <- 0
q3_4 <- barplot(Q3_4_rel,
        main = "In Ihrer Anwendung, wie gut funktioniert welche Art von Fernerkundungsdaten?", 
        sub = paste("total n", "=", length(rowSums(Q3_4, na.rm=T)!=0), sep = " "),
        names.arg = c("LIDAR", "RADAR", "multispetral", "hyperspektral", "Wärmebilder", "Orthophotos", "andere"),
        ylim = c(0,max(Q3_4_rel)+20), yaxt='n',
        beside = TRUE, 
        legend.text = TRUE,
        args.legend = list("topright", bty = "n"))
text(x = q3_4, y = Q3_4_rel, label = paste("n = ", Q3_4_sum, " / ", round(Q3_4_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q3_5_sum <- colSums(Q3_5, na.rm = TRUE)
Q3_5_rel <- 100/sum(Q3_5_sum)*Q3_5_sum
q3_5 <- barplot(Q3_5_rel,
        main = "Zur Berichterstattung für welche(n) Politikprozess(e) nutzen Sie Fernerkundungsdaten?", 
        sub = paste("total n", "=", length(which(rowSums(Q3_5, na.rm=T)!=0)), sep = " "),
        names.arg = c("Deutsche Nationale Biodiversitätsstrategie", 
                                        "Europäische Biodiversitätsstrategie",
                                        "Gemeinsame Agrarpolitik der EU (GAP)",
                                        "Natura 2000",
                                        "Fauna-Flora-Habitat-Richtlinie (FFH)",
                                        "Übereinkommen über die biologische Vielfalt (CBD)",
                                        "Intergovernmental science-policy Platform on Biodiversity and Ecosystem Services (IPBES)",
                                        "Washingtoner Artenschutzabkommen (CITES",
                                        "Übereinkommen zur Erhaltung wandernder wild lebender Tierarten (CMS)",
                                        "Abkommen zur Erhaltung der europäischen Fledermauspopulationen (EUROBATS)",
                                        "Übereinkommen über Feuchtgebiete (Ramsar)",
                                        "Group on Earth Observations (GEO)",
                                        "Andere"),
        ylim = c(0,max(Q3_5_rel)+5), yaxt='n')
text(x = q3_5, y = Q3_5_rel, label = paste("n = ", Q3_5_sum, " / ", round(Q3_5_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")

Q3_7_sum <- as.numeric(table(Q3_7))
names(Q3_7_sum) <- c("3_7_a", "3_7_b")
Q3_7_rel <- 100/sum(Q3_7_sum)*Q3_7_sum
q3_7 <- barplot(Q3_7_rel,
        main = "Nutzen Sie bereits Fernerkundungsdaten in Ihrer Arbeit?", 
        sub = paste("total n", "=", length(ergebnisse$X3_7[!is.na(ergebnisse$X3_7) == T]), sep = " "),
        names.arg = c("Ja", "Nein"),
        ylim = c(0,max(Q3_7_rel)+5), yaxt='n')
text(x = q3_7, y = Q3_7_rel, label = paste("n = ", Q3_7_sum, " / ", round(Q3_7_rel, digits = 0), "%", sep = ""), pos = 3, cex = 0.8, col = "black")



```

